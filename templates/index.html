<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hotel Management System</title>
    <style>
        :root {
            --primary-color: #4a6fa5;
            --secondary-color: #6b8cae;
            --accent-color: #ff7e5f;
            --light-color: #f8f9fa;
            --dark-color: #343a40;
            --success-color: #28a745;
            --danger-color: #dc3545;
            --warning-color: #ffc107;
            --info-color: #17a2b8;
            --glass-bg: rgba(255, 255, 255, 0.15);
            --glass-border: rgba(255, 255, 255, 0.18);
            --glass-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: var(--light-color);
            overflow-x: hidden;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Glassmorphism effect */
        .glass-card {
            background: var(--glass-bg);
            backdrop-filter: blur(16px);
            -webkit-backdrop-filter: blur(16px);
            border-radius: 12px;
            border: 1px solid var(--glass-border);
            box-shadow: var(--glass-shadow);
            padding: 20px;
            margin-bottom: 20px;
        }

        /* Header */
        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 0;
            margin-bottom: 30px;
        }

        .logo {
            font-size: 24px;
            font-weight: bold;
            display: flex;
            align-items: center;
        }

        .logo i {
            margin-right: 10px;
            font-size: 28px;
        }

        .auth-buttons button {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            padding: 8px 16px;
            border-radius: 20px;
            color: white;
            cursor: pointer;
            margin-left: 10px;
            transition: all 0.3s ease;
        }

        .auth-buttons button:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        /* Login Form */
        .login-form {
            max-width: 400px;
            margin: 50px auto;
            padding: 30px;
        }

        .login-form h2 {
            text-align: center;
            margin-bottom: 20px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
        }

        .form-group input {
            width: 100%;
            padding: 12px;
            border-radius: 8px;
            border: none;
            background: rgba(255, 255, 255, 0.2);
            color: white;
        }

        .form-group input::placeholder {
            color: rgba(255, 255, 255, 0.7);
        }

        .form-group input:focus {
            outline: none;
            background: rgba(255, 255, 255, 0.3);
        }

        .login-btn {
            width: 100%;
            padding: 12px;
            border-radius: 8px;
            border: none;
            background: var(--accent-color);
            color: white;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .login-btn:hover {
            background: #ff6a4f;
        }

        /* Dashboard */
        .dashboard {
            display: none;
        }

        .welcome-message {
            margin-bottom: 30px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            padding: 20px;
            text-align: center;
            border-radius: 12px;
            transition: transform 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-5px);
        }

        .stat-card i {
            font-size: 36px;
            margin-bottom: 10px;
        }

        .stat-card h3 {
            font-size: 24px;
            margin-bottom: 5px;
        }

        .stat-card p {
            opacity: 0.8;
        }

        /* Tables */
        .table-container {
            overflow-x: auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            overflow: hidden;
        }

        th, td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        th {
            background: rgba(255, 255, 255, 0.2);
            font-weight: 600;
        }

        tr:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        .status {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: bold;
        }

        .status-available {
            background: var(--success-color);
        }

        .status-booked {
            background: var(--warning-color);
            color: var(--dark-color);
        }

        .status-maintenance {
            background: var(--danger-color);
        }

        .status-active {
            background: var(--success-color);
        }

        .status-completed {
            background: var(--info-color);
        }

        .status-pending {
            background: var(--warning-color);
            color: var(--dark-color);
        }

        .status-paid {
            background: var(--success-color);
        }

        /* Buttons */
        .btn {
            padding: 8px 16px;
            border-radius: 6px;
            border: none;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .btn-primary {
            background: var(--primary-color);
            color: white;
        }

        .btn-primary:hover {
            background: #3a5a8f;
        }

        .btn-success {
            background: var(--success-color);
            color: white;
        }

        .btn-success:hover {
            background: #218838;
        }

        .btn-danger {
            background: var(--danger-color);
            color: white;
        }

        .btn-danger:hover {
            background: #c82333;
        }

        .btn-sm {
            padding: 6px 12px;
            font-size: 12px;
        }

        /* Tabs */
        .tabs {
            display: flex;
            margin-bottom: 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
        }

        .tab {
            padding: 10px 20px;
            cursor: pointer;
            opacity: 0.7;
            transition: all 0.3s ease;
        }

        .tab.active {
            opacity: 1;
            border-bottom: 2px solid var(--accent-color);
        }

        .tab:hover {
            opacity: 1;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* Forms */
        .form-row {
            display: flex;
            gap: 20px;
            margin-bottom: 15px;
        }

        .form-col {
            flex: 1;
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background: var(--glass-bg);
            backdrop-filter: blur(16px);
            -webkit-backdrop-filter: blur(16px);
            border-radius: 12px;
            padding: 30px;
            width: 90%;
            max-width: 600px;
            max-height: 90vh;
            overflow-y: auto;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .modal-header h3 {
            font-size: 20px;
        }

        .close-modal {
            background: none;
            border: none;
            color: white;
            font-size: 24px;
            cursor: pointer;
        }

        /* Room cards */
        .rooms-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 20px;
        }

        .room-card {
            border-radius: 12px;
            overflow: hidden;
            transition: transform 0.3s ease;
        }

        .room-card:hover {
            transform: translateY(-5px);
        }

        .room-image {
            height: 180px;
            background-size: cover;
            background-position: center;
            position: relative;
        }

        .room-price {
            position: absolute;
            top: 10px;
            right: 10px;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 5px 10px;
            border-radius: 20px;
            font-weight: bold;
        }

        .room-details {
            padding: 15px;
            background: rgba(255, 255, 255, 0.1);
        }

        .room-title {
            font-size: 18px;
            margin-bottom: 5px;
            display: flex;
            justify-content: space-between;
        }

        .room-meta {
            display: flex;
            gap: 10px;
            margin-bottom: 10px;
            font-size: 14px;
            opacity: 0.8;
        }

        .room-meta span {
            display: flex;
            align-items: center;
        }

        .room-meta i {
            margin-right: 5px;
        }

        .room-actions {
            display: flex;
            justify-content: space-between;
            margin-top: 15px;
        }

        /* Search and filters */
        .search-bar {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .search-input {
            flex: 1;
            padding: 10px 15px;
            border-radius: 8px;
            border: none;
            background: rgba(255, 255, 255, 0.2);
            color: white;
        }

        .search-input::placeholder {
            color: rgba(255, 255, 255, 0.7);
        }

        .filter-select {
            padding: 10px;
            border-radius: 8px;
            border: none;
            background: rgba(255, 255, 255, 0.2);
            color: white;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .stats-grid {
                grid-template-columns: 1fr 1fr;
            }
            
            .form-row {
                flex-direction: column;
                gap: 0;
            }
            
            .search-bar {
                flex-direction: column;
            }
        }

        @media (max-width: 480px) {
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            header {
                flex-direction: column;
                gap: 15px;
            }
            
            .auth-buttons {
                width: 100%;
                display: flex;
                justify-content: space-between;
            }
            
            .auth-buttons button {
                margin: 0;
                flex: 1;
            }
        }

        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .fade-in {
            animation: fadeIn 0.5s ease forwards;
        }

        /* Utility classes */
        .text-center {
            text-align: center;
        }

        .mb-20 {
            margin-bottom: 20px;
        }

        .mt-20 {
            margin-top: 20px;
        }

        .flex-between {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        /* Font Awesome icons */
        .fas, .far {
            display: inline-block;
            margin-right: 5px;
        }
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
</head>
<body>
    <div class="container">
        <!-- Login Screen -->
        <div id="login-screen">
            <header>
                <div class="logo">
                    <i class="fas fa-hotel"></i>
                    <span>Hotel Management</span>
                </div>
            </header>
            
            <div class="glass-card login-form fade-in">
                <h2>Welcome Back</h2>
                <form id="login-form">
                    <div class="form-group">
                        <label for="username">Username</label>
                        <input type="text" id="username" placeholder="Enter your username" required>
                    </div>
                    <div class="form-group">
                        <label for="password">Password</label>
                        <input type="password" id="password" placeholder="Enter your password" required>
                    </div>
                    <button type="submit" class="login-btn">Login</button>
                </form>
            </div>
        </div>
        
        <!-- Dashboard -->
        <div id="dashboard" class="dashboard">
            <header>
                <div class="logo">
                    <i class="fas fa-hotel"></i>
                    <span>Hotel Management</span>
                </div>
                <div class="auth-buttons">
                    <span id="user-name"></span>
                    <button id="logout-btn"><i class="fas fa-sign-out-alt"></i> Logout</button>
                </div>
            </header>
            
            <div class="welcome-message glass-card">
                <h2>Welcome, <span id="welcome-name"></span></h2>
                <p>Here's what's happening with your hotel today.</p>
            </div>
            
            <div class="tabs">
                <div class="tab active" data-tab="dashboard-tab">Dashboard</div>
                <div class="tab" data-tab="rooms-tab">Rooms</div>
                <div class="tab" data-tab="bookings-tab">Bookings</div>
                <div class="tab" data-tab="customers-tab">Customers</div>
            </div>
            
            <!-- Dashboard Tab -->
            <div id="dashboard-tab" class="tab-content active">
                <h3 class="mb-20">Overview</h3>
                
                <div class="stats-grid">
                    <div class="glass-card stat-card">
                        <i class="fas fa-door-open"></i>
                        <h3 id="total-rooms">0</h3>
                        <p>Total Rooms</p>
                    </div>
                    <div class="glass-card stat-card">
                        <i class="fas fa-bed"></i>
                        <h3 id="available-rooms">0</h3>
                        <p>Available Rooms</p>
                    </div>
                    <div class="glass-card stat-card">
                        <i class="fas fa-calendar-check"></i>
                        <h3 id="active-bookings">0</h3>
                        <p>Active Bookings</p>
                    </div>
                    <div class="glass-card stat-card">
                        <i class="fas fa-users"></i>
                        <h3 id="total-customers">0</h3>
                        <p>Total Customers</p>
                    </div>
                </div>
                
                <h3 class="mb-20">Recent Bookings</h3>
                <div class="glass-card">
                    <div class="table-container">
                        <table id="recent-bookings">
                            <thead>
                                <tr>
                                    <th>Booking ID</th>
                                    <th>Room</th>
                                    <th>Customer</th>
                                    <th>Check-in</th>
                                    <th>Check-out</th>
                                    <th>Amount</th>
                                    <th>Status</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Filled by JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            
            <!-- Rooms Tab -->
            <div id="rooms-tab" class="tab-content">
                <div class="flex-between mb-20">
                    <h3>Room Management</h3>
                    <button class="btn btn-primary" id="add-room-btn"><i class="fas fa-plus"></i> Add Room</button>
                </div>
                
                <div class="search-bar">
                    <input type="text" id="room-search" class="search-input" placeholder="Search rooms...">
                    <select id="room-type-filter" class="filter-select">
                        <option value="">All Types</option>
                        <option value="Deluxe">Deluxe</option>
                        <option value="Standard">Standard</option>
                        <option value="Suite">Suite</option>
                        <option value="Executive">Executive</option>
                    </select>
                    <select id="room-status-filter" class="filter-select">
                        <option value="">All Statuses</option>
                        <option value="available">Available</option>
                        <option value="booked">Booked</option>
                        <option value="maintenance">Maintenance</option>
                    </select>
                </div>
                
                <div class="rooms-grid" id="rooms-container">
                    <!-- Filled by JavaScript -->
                </div>
            </div>
            
            <!-- Bookings Tab -->
            <div id="bookings-tab" class="tab-content">
                <div class="flex-between mb-20">
                    <h3>Booking Management</h3>
                    <button class="btn btn-primary" id="add-booking-btn"><i class="fas fa-plus"></i> New Booking</button>
                </div>
                
                <div class="search-bar">
                    <input type="text" id="booking-search" class="search-input" placeholder="Search bookings...">
                    <select id="booking-status-filter" class="filter-select">
                        <option value="">All Statuses</option>
                        <option value="active">Active</option>
                        <option value="completed">Completed</option>
                    </select>
                </div>
                
                <div class="glass-card">
                    <div class="table-container">
                        <table id="bookings-table">
                            <thead>
                                <tr>
                                    <th>Booking ID</th>
                                    <th>Room</th>
                                    <th>Customer</th>
                                    <th>Check-in</th>
                                    <th>Check-out</th>
                                    <th>Amount</th>
                                    <th>Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Filled by JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            
            <!-- Customers Tab -->
            <div id="customers-tab" class="tab-content">
                <div class="flex-between mb-20">
                    <h3>Customer Management</h3>
                    <button class="btn btn-primary" id="add-customer-btn"><i class="fas fa-plus"></i> Add Customer</button>
                </div>
                
                <div class="search-bar">
                    <input type="text" id="customer-search" class="search-input" placeholder="Search customers...">
                </div>
                
                <div class="glass-card">
                    <div class="table-container">
                        <table id="customers-table">
                            <thead>
                                <tr>
                                    <th>Name</th>
                                    <th>Email</th>
                                    <th>Phone</th>
                                    <th>ID Proof</th>
                                    <th>ID Number</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Filled by JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Add Room Modal -->
    <div class="modal" id="add-room-modal">
        <div class="modal-content glass-card">
            <div class="modal-header">
                <h3>Add New Room</h3>
                <button class="close-modal">&times;</button>
            </div>
            <form id="add-room-form">
                <div class="form-row">
                    <div class="form-col">
                        <div class="form-group">
                            <label for="room-number">Room Number</label>
                            <input type="text" id="room-number" required>
                        </div>
                    </div>
                    <div class="form-col">
                        <div class="form-group">
                            <label for="room-type">Room Type</label>
                            <select id="room-type" required>
                                <option value="">Select Type</option>
                                <option value="Deluxe">Deluxe</option>
                                <option value="Standard">Standard</option>
                                <option value="Suite">Suite</option>
                                <option value="Executive">Executive</option>
                            </select>
                        </div>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-col">
                        <div class="form-group">
                            <label for="room-price">Price per Night ($)</label>
                            <input type="number" id="room-price" required>
                        </div>
                    </div>
                    <div class="form-col">
                        <div class="form-group">
                            <label for="room-capacity">Capacity</label>
                            <input type="number" id="room-capacity" required>
                        </div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="room-amenities">Amenities (comma separated)</label>
                    <input type="text" id="room-amenities" placeholder="e.g., WiFi, TV, AC, Mini Bar">
                </div>
                
                <div class="form-group">
                    <label for="room-description">Description</label>
                    <textarea id="room-description" rows="3" style="width: 100%; padding: 10px; border-radius: 8px; border: none; background: rgba(255, 255, 255, 0.2); color: white;"></textarea>
                </div>
                
                <div class="form-group">
                    <label for="room-image">Room Image</label>
                    <input type="file" id="room-image" accept="image/*">
                </div>
                
                <div class="form-group mt-20">
                    <button type="submit" class="btn btn-primary">Add Room</button>
                </div>
            </form>
        </div>
    </div>
    
    <!-- Add Booking Modal -->
    <div class="modal" id="add-booking-modal">
        <div class="modal-content glass-card">
            <div class="modal-header">
                <h3>New Booking</h3>
                <button class="close-modal">&times;</button>
            </div>
            <form id="add-booking-form">
                <div class="form-row">
                    <div class="form-col">
                        <div class="form-group">
                            <label for="booking-room">Room</label>
                            <select id="booking-room" required>
                                <option value="">Select Room</option>
                                <!-- Filled by JavaScript -->
                            </select>
                        </div>
                    </div>
                    <div class="form-col">
                        <div class="form-group">
                            <label for="booking-customer">Customer</label>
                            <select id="booking-customer" required>
                                <option value="">Select Customer</option>
                                <!-- Filled by JavaScript -->
                            </select>
                        </div>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-col">
                        <div class="form-group">
                            <label for="check-in-date">Check-in Date</label>
                            <input type="date" id="check-in-date" required>
                        </div>
                    </div>
                    <div class="form-col">
                        <div class="form-group">
                            <label for="check-out-date">Check-out Date</label>
                            <input type="date" id="check-out-date" required>
                        </div>
                    </div>
                </div>
                
                <div class="form-group mt-20">
                    <button type="submit" class="btn btn-primary">Create Booking</button>
                </div>
            </form>
        </div>
    </div>
    
    <!-- Add Customer Modal -->
    <div class="modal" id="add-customer-modal">
        <div class="modal-content glass-card">
            <div class="modal-header">
                <h3>Add New Customer</h3>
                <button class="close-modal">&times;</button>
            </div>
            <form id="add-customer-form">
                <div class="form-row">
                    <div class="form-col">
                        <div class="form-group">
                            <label for="customer-name">Full Name</label>
                            <input type="text" id="customer-name" required>
                        </div>
                    </div>
                    <div class="form-col">
                        <div class="form-group">
                            <label for="customer-email">Email</label>
                            <input type="email" id="customer-email" required>
                        </div>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-col">
                        <div class="form-group">
                            <label for="customer-phone">Phone</label>
                            <input type="tel" id="customer-phone" required>
                        </div>
                    </div>
                    <div class="form-col">
                        <div class="form-group">
                            <label for="customer-id-proof">ID Proof Type</label>
                            <select id="customer-id-proof">
                                <option value="">Select ID Proof</option>
                                <option value="AADHAR">Aadhar</option>
                                <option value="PASSPORT">Passport</option>
                                <option value="DRIVING_LICENSE">Driving License</option>
                            </select>
                        </div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="customer-id-number">ID Number</label>
                    <input type="text" id="customer-id-number">
                </div>
                
                <div class="form-group">
                    <label for="customer-address">Address</label>
                    <textarea id="customer-address" rows="3" style="width: 100%; padding: 10px; border-radius: 8px; border: none; background: rgba(255, 255, 255, 0.2); color: white;"></textarea>
                </div>
                
                <div class="form-group mt-20">
                    <button type="submit" class="btn btn-primary">Add Customer</button>
                </div>
            </form>
        </div>
    </div>
    
    <!-- Booking Details Modal -->
    <div class="modal" id="booking-details-modal">
        <div class="modal-content glass-card">
            <div class="modal-header">
                <h3>Booking Details</h3>
                <button class="close-modal">&times;</button>
            </div>
            <div id="booking-details-content">
                <!-- Filled by JavaScript -->
            </div>
            <div class="mt-20">
                <button class="btn btn-success" id="generate-invoice-btn"><i class="fas fa-file-pdf"></i> Generate Invoice</button>
                <button class="btn btn-danger" id="checkout-btn" style="display: none;"><i class="fas fa-door-open"></i> Checkout</button>
            </div>
        </div>
    </div>
    
    <script>
    // Global variables
    let currentUser = null;
    
    // DOM Elements
    const loginScreen = document.getElementById('login-screen');
    const dashboard = document.getElementById('dashboard');
    const loginForm = document.getElementById('login-form');
    const logoutBtn = document.getElementById('logout-btn');
    const welcomeName = document.getElementById('welcome-name');
    const userName = document.getElementById('user-name');
    
    // Tab elements
    const tabs = document.querySelectorAll('.tab');
    const tabContents = document.querySelectorAll('.tab-content');
    
    // Modal elements
    const modals = document.querySelectorAll('.modal');
    const closeModalButtons = document.querySelectorAll('.close-modal');
    const addRoomBtn = document.getElementById('add-room-btn');
    const addBookingBtn = document.getElementById('add-booking-btn');
    const addCustomerBtn = document.getElementById('add-customer-btn');
    
    // Forms
    const addRoomForm = document.getElementById('add-room-form');
    const addBookingForm = document.getElementById('add-booking-form');
    const addCustomerForm = document.getElementById('add-customer-form');
    
    // Initialize the app
    document.addEventListener('DOMContentLoaded', () => {
        // Check if user is already logged in
        const storedUser = localStorage.getItem('hotelUser');
        if (storedUser) {
            currentUser = JSON.parse(storedUser);
            showDashboard();
            loadDashboardData();
        }
        
        // Set up event listeners
        setupEventListeners();
    });
    
    // Set up all event listeners
    function setupEventListeners() {
        // Login form
        loginForm.addEventListener('submit', handleLogin);
        
        // Logout button
        logoutBtn.addEventListener('click', handleLogout);
        
        // Tab switching
        tabs.forEach(tab => {
            tab.addEventListener('click', () => {
                const tabId = tab.getAttribute('data-tab');
                switchTab(tabId);
            });
        });
        
        // Modal handling
        addRoomBtn.addEventListener('click', () => openModal('add-room-modal'));
        addBookingBtn.addEventListener('click', () => {
            openModal('add-booking-modal');
            loadRoomsForBooking();
            loadCustomersForBooking();
        });
        addCustomerBtn.addEventListener('click', () => openModal('add-customer-modal'));
        
        closeModalButtons.forEach(btn => {
            btn.addEventListener('click', closeAllModals);
        });
        
        modals.forEach(modal => {
            modal.addEventListener('click', (e) => {
                if (e.target === modal) {
                    closeAllModals();
                }
            });
        });
        
        // Form submissions
        addRoomForm.addEventListener('submit', handleAddRoom);
        addBookingForm.addEventListener('submit', handleAddBooking);
        addCustomerForm.addEventListener('submit', handleAddCustomer);
        
        // Search and filter inputs
        document.getElementById('room-search').addEventListener('input', filterRooms);
        document.getElementById('room-type-filter').addEventListener('change', filterRooms);
        document.getElementById('room-status-filter').addEventListener('change', filterRooms);
        
        document.getElementById('booking-search').addEventListener('input', filterBookings);
        document.getElementById('booking-status-filter').addEventListener('change', filterBookings);
        
        document.getElementById('customer-search').addEventListener('input', filterCustomers);
        
        // Check-in date min attribute
        document.getElementById('check-in-date').min = new Date().toISOString().split('T')[0];
        document.getElementById('check-in-date').addEventListener('change', function() {
            document.getElementById('check-out-date').min = this.value;
        });
    }
    
    // Handle login
    async function handleLogin(e) {
        e.preventDefault();
        
        const username = document.getElementById('username').value;
        const password = document.getElementById('password').value;
        
        try {
            const response = await fetch('/api/login', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ username, password })
            });
            
            const data = await response.json();
            
            if (data.success) {
                currentUser = data.user;
                localStorage.setItem('hotelUser', JSON.stringify({
                    ...currentUser,
                    token: data.token
                }));
                showDashboard();
                loadDashboardData();
            } else {
                alert(data.message || 'Login failed');
            }
        } catch (error) {
            console.error('Login error:', error);
            alert('An error occurred during login');
        }
    }
    
    // Handle logout
    function handleLogout() {
        currentUser = null;
        localStorage.removeItem('hotelUser');
        showLoginScreen();
    }
    
    // Show login screen
    function showLoginScreen() {
        loginScreen.style.display = 'block';
        dashboard.style.display = 'none';
        loginForm.reset();
    }
    
    // Show dashboard
    function showDashboard() {
        loginScreen.style.display = 'none';
        dashboard.style.display = 'block';
        
        welcomeName.textContent = currentUser.name;
        userName.textContent = currentUser.name;
    }
    
    // Switch between tabs
    function switchTab(tabId) {
        // Update active tab
        tabs.forEach(tab => {
            if (tab.getAttribute('data-tab') === tabId) {
                tab.classList.add('active');
            } else {
                tab.classList.remove('active');
            }
        });
        
        // Update active content
        tabContents.forEach(content => {
            if (content.id === tabId) {
                content.classList.add('active');
                
                // Load data when tab is activated
                if (tabId === 'rooms-tab') {
                    loadRooms();
                } else if (tabId === 'bookings-tab') {
                    loadBookings();
                } else if (tabId === 'customers-tab') {
                    loadCustomers();
                }
            } else {
                content.classList.remove('active');
            }
        });
    }
    
    // Open a modal
    function openModal(modalId) {
        document.getElementById(modalId).style.display = 'flex';
    }
    
    // Close all modals
    function closeAllModals() {
        modals.forEach(modal => {
            modal.style.display = 'none';
        });
    }
    
    // In the loadDashboardData function, update the recent bookings section:
async function loadDashboardData() {
    try {
        const userData = JSON.parse(localStorage.getItem('hotelUser'));
        const response = await fetch('/api/dashboard', {
            headers: {
                'Authorization': `Bearer ${userData.token}`
            }
        });
        
        if (response.status === 401) {
            handleLogout();
            return;
        }
        
        const data = await response.json();
        
        // Update stats
        document.getElementById('total-rooms').textContent = data.stats.total_rooms;
        document.getElementById('available-rooms').textContent = data.stats.available_rooms;
        document.getElementById('active-bookings').textContent = data.stats.active_bookings;
        document.getElementById('total-customers').textContent = data.stats.total_customers;
        
        // Update recent bookings
        const bookingsTable = document.querySelector('#recent-bookings tbody');
        bookingsTable.innerHTML = '';
        
        if (data.recent_bookings && data.recent_bookings.length > 0) {
            data.recent_bookings.forEach(booking => {
                const row = document.createElement('tr');
                
                row.innerHTML = `
                    <td>${booking.id.substring(0, 8)}...</td>
                    <td>${booking.room.type} (${booking.room.number})</td>
                    <td>${booking.customer.name}</td>
                    <td>${booking.check_in}</td>
                    <td>${booking.check_out}</td>
                    <td>$${booking.total_amount}</td>
                    <td><span class="status status-${booking.status}">${booking.status}</span></td>
                `;
                
                row.addEventListener('click', () => showBookingDetails(booking.id));
                bookingsTable.appendChild(row);
            });
        } else {
            bookingsTable.innerHTML = '<tr><td colspan="7" class="text-center">No recent bookings found</td></tr>';
        }
    } catch (error) {
        console.error('Error loading dashboard data:', error);
    }
}
    
    // Load rooms
    async function loadRooms() {
        try {
            const userData = JSON.parse(localStorage.getItem('hotelUser'));
            const response = await fetch('/api/rooms', {
                headers: {
                    'Authorization': `Bearer ${userData.token}`
                }
            });
            
            if (response.status === 401) {
                handleLogout();
                return;
            }
            
            const data = await response.json();
            renderRooms(data.rooms);
        } catch (error) {
            console.error('Error loading rooms:', error);
        }
    }
    
    // Render rooms in grid
    function renderRooms(rooms) {
        const container = document.getElementById('rooms-container');
        container.innerHTML = '';
        
        rooms.forEach(room => {
            const roomCard = document.createElement('div');
            roomCard.className = 'room-card glass-card';
            
            roomCard.innerHTML = `
                <div class="room-image" style="background-image: url('${room.image || 'https://via.placeholder.com/300x200'}')">
                    <span class="room-price">$${room.price}/night</span>
                </div>
                <div class="room-details">
                    <div class="room-title">
                        <span>${room.type} Room</span>
                        <span class="status status-${room.status}">${room.status}</span>
                    </div>
                    <div class="room-meta">
                        <span><i class="fas fa-door-open"></i> ${room.number}</span>
                        <span><i class="fas fa-user-friends"></i> ${room.capacity}</span>
                    </div>
                    <p>${room.description || 'Comfortable room with modern amenities'}</p>
                    <div class="room-actions">
                        <button class="btn btn-sm btn-primary view-room-btn" data-room-id="${room.id}">View Details</button>
                        <button class="btn btn-sm btn-success book-room-btn" data-room-id="${room.id}">Book Now</button>
                    </div>
                </div>
            `;
            
            container.appendChild(roomCard);
        });
        
        // Add event listeners to room buttons
        document.querySelectorAll('.view-room-btn').forEach(btn => {
            btn.addEventListener('click', (e) => {
                const roomId = e.target.getAttribute('data-room-id');
                showRoomDetails(roomId);
            });
        });
        
        document.querySelectorAll('.book-room-btn').forEach(btn => {
            btn.addEventListener('click', (e) => {
                const roomId = e.target.getAttribute('data-room-id');
                openModal('add-booking-modal');
                document.getElementById('booking-room').value = roomId;
                loadCustomersForBooking();
            });
        });
    }
    
    // Show room details
    async function showRoomDetails(roomId) {
        try {
            const userData = JSON.parse(localStorage.getItem('hotelUser'));
            const response = await fetch(`/api/rooms/${roomId}`, {
                headers: {
                    'Authorization': `Bearer ${userData.token}`
                }
            });
            
            if (response.status === 401) {
                handleLogout();
                return;
            }
            
            const room = await response.json();
            
            // Create a modal to show room details
            const modalContent = `
                <div class="modal-header">
                    <h3>${room.type} Room Details</h3>
                    <button class="close-modal">&times;</button>
                </div>
                <div>
                    <div style="display: flex; gap: 20px; margin-bottom: 20px;">
                        <div style="flex: 1;">
                            <img src="${room.image || 'https://via.placeholder.com/300x200'}" alt="Room Image" style="width: 100%; border-radius: 8px;">
                        </div>
                        <div style="flex: 1;">
                            <h4>Room #${room.number}</h4>
                            <p><strong>Status:</strong> <span class="status status-${room.status}">${room.status}</span></p>
                            <p><strong>Price:</strong> $${room.price}/night</p>
                            <p><strong>Capacity:</strong> ${room.capacity} persons</p>
                            <p><strong>Amenities:</strong> ${room.amenities}</p>
                        </div>
                    </div>
                    <div>
                        <h4>Description</h4>
                        <p>${room.description}</p>
                    </div>
                </div>
            `;
            
            // Create a temporary modal to show the details
            const tempModal = document.createElement('div');
            tempModal.className = 'modal';
            tempModal.style.display = 'flex';
            tempModal.innerHTML = `
                <div class="modal-content glass-card">
                    ${modalContent}
                </div>
            `;
            
            // Add close functionality
            tempModal.querySelector('.close-modal').addEventListener('click', () => {
                document.body.removeChild(tempModal);
            });
            
            tempModal.addEventListener('click', (e) => {
                if (e.target === tempModal) {
                    document.body.removeChild(tempModal);
                }
            });
            
            document.body.appendChild(tempModal);
        } catch (error) {
            console.error('Error loading room details:', error);
            alert('Failed to load room details');
        }
    }
    
    // Filter rooms based on search and filters
    async function filterRooms() {
        const search = document.getElementById('room-search').value;
        const type = document.getElementById('room-type-filter').value;
        const status = document.getElementById('room-status-filter').value;
        
        try {
            const userData = JSON.parse(localStorage.getItem('hotelUser'));
            let url = `/api/rooms?`;
            if (search) url += `search=${search}&`;
            if (type) url += `type=${type}&`;
            if (status) url += `status=${status}&`;
            
            const response = await fetch(url, {
                headers: {
                    'Authorization': `Bearer ${userData.token}`
                }
            });
            
            if (response.status === 401) {
                handleLogout();
                return;
            }
            
            const data = await response.json();
            renderRooms(data.rooms);
        } catch (error) {
            console.error('Error filtering rooms:', error);
        }
    }
    
    // Load bookings
    async function loadBookings() {
        try {
            const userData = JSON.parse(localStorage.getItem('hotelUser'));
            const response = await fetch('/api/bookings', {
                headers: {
                    'Authorization': `Bearer ${userData.token}`
                }
            });
            
            if (response.status === 401) {
                handleLogout();
                return;
            }
            
            const data = await response.json();
            renderBookings(data.bookings);
        } catch (error) {
            console.error('Error loading bookings:', error);
        }
    }
    
    // Render bookings in table
    function renderBookings(bookings) {
        const tableBody = document.querySelector('#bookings-table tbody');
        tableBody.innerHTML = '';
        
        bookings.forEach(booking => {
            const row = document.createElement('tr');
            
            row.innerHTML = `
                <td>${booking.id.substring(0, 8)}...</td>
                <td>${booking.room.type} (${booking.room.number})</td>
                <td>${booking.customer.name}</td>
                <td>${booking.check_in}</td>
                <td>${booking.check_out}</td>
                <td>$${booking.total_amount}</td>
                <td><span class="status status-${booking.status}">${booking.status}</span></td>
                <td>
                    <button class="btn btn-sm btn-primary" data-booking-id="${booking.id}">Details</button>
                    ${booking.status === 'active' ? `<button class="btn btn-sm btn-danger" data-booking-id="${booking.id}">Checkout</button>` : ''}
                </td>
            `;
            
            tableBody.appendChild(row);
        });
        
        // Add event listeners to booking buttons
        document.querySelectorAll('#bookings-table button').forEach(btn => {
            btn.addEventListener('click', (e) => {
                const bookingId = e.target.getAttribute('data-booking-id');
                if (btn.classList.contains('btn-primary')) {
                    showBookingDetails(bookingId);
                } else if (btn.classList.contains('btn-danger')) {
                    checkoutBooking(bookingId);
                }
            });
        });
    }
    
    // Filter bookings based on search and filters
    async function filterBookings() {
        const search = document.getElementById('booking-search').value;
        const status = document.getElementById('booking-status-filter').value;
        
        try {
            const userData = JSON.parse(localStorage.getItem('hotelUser'));
            let url = `/api/bookings?`;
            if (search) url += `search=${search}&`;
            if (status) url += `status=${status}&`;
            
            const response = await fetch(url, {
                headers: {
                    'Authorization': `Bearer ${userData.token}`
                }
            });
            
            if (response.status === 401) {
                handleLogout();
                return;
            }
            
            const data = await response.json();
            renderBookings(data.bookings);
        } catch (error) {
            console.error('Error filtering bookings:', error);
        }
    }
    
    // Load customers
    async function loadCustomers() {
        try {
            const userData = JSON.parse(localStorage.getItem('hotelUser'));
            const response = await fetch('/api/customers', {
                headers: {
                    'Authorization': `Bearer ${userData.token}`
                }
            });
            
            if (response.status === 401) {
                handleLogout();
                return;
            }
            
            const data = await response.json();
            renderCustomers(data.customers);
        } catch (error) {
            console.error('Error loading customers:', error);
        }
    }
    
    // Render customers in table
    function renderCustomers(customers) {
        const tableBody = document.querySelector('#customers-table tbody');
        tableBody.innerHTML = '';
        
        customers.forEach(customer => {
            const row = document.createElement('tr');
            
            row.innerHTML = `
                <td>${customer.name}</td>
                <td>${customer.email}</td>
                <td>${customer.phone}</td>
                <td>${customer.id_proof || '-'}</td>
                <td>${customer.id_number || '-'}</td>
                <td>
                    <button class="btn btn-sm btn-primary edit-customer-btn" data-customer-id="${customer.id}">Edit</button>
                </td>
            `;
            
            tableBody.appendChild(row);
        });
        
        // Add event listeners to edit buttons
        document.querySelectorAll('.edit-customer-btn').forEach(btn => {
            btn.addEventListener('click', (e) => {
                const customerId = e.target.getAttribute('data-customer-id');
                editCustomer(customerId);
            });
        });
    }
    
    // Edit customer
    async function editCustomer(customerId) {
        try {
            const userData = JSON.parse(localStorage.getItem('hotelUser'));
            const response = await fetch(`/api/customers`, {
                headers: {
                    'Authorization': `Bearer ${userData.token}`
                }
            });
            
            if (response.status === 401) {
                handleLogout();
                return;
            }
            
            const data = await response.json();
            const customer = data.customers.find(c => c.id === customerId);
            
            if (!customer) {
                alert('Customer not found');
                return;
            }
            
            // Populate the add customer form with existing data
            document.getElementById('customer-name').value = customer.name;
            document.getElementById('customer-email').value = customer.email;
            document.getElementById('customer-phone').value = customer.phone;
            document.getElementById('customer-id-proof').value = customer.id_proof || '';
            document.getElementById('customer-id-number').value = customer.id_number || '';
            document.getElementById('customer-address').value = customer.address || '';
            
            // Change the form to update mode
            const form = document.getElementById('add-customer-form');
            form.setAttribute('data-customer-id', customerId);
            form.querySelector('button').textContent = 'Update Customer';
            
            // Open the modal
            openModal('add-customer-modal');
        } catch (error) {
            console.error('Error editing customer:', error);
            alert('Failed to load customer details');
        }
    }
    
    // Filter customers based on search
    async function filterCustomers() {
        const search = document.getElementById('customer-search').value;
        
        try {
            const userData = JSON.parse(localStorage.getItem('hotelUser'));
            let url = `/api/customers?`;
            if (search) url += `search=${search}&`;
            
            const response = await fetch(url, {
                headers: {
                    'Authorization': `Bearer ${userData.token}`
                }
            });
            
            if (response.status === 401) {
                handleLogout();
                return;
            }
            
            const data = await response.json();
            renderCustomers(data.customers);
        } catch (error) {
            console.error('Error filtering customers:', error);
        }
    }
    
    // Load rooms for booking form
    async function loadRoomsForBooking() {
        try {
            const userData = JSON.parse(localStorage.getItem('hotelUser'));
            const response = await fetch('/api/rooms?status=available', {
                headers: {
                    'Authorization': `Bearer ${userData.token}`
                }
            });
            
            if (response.status === 401) {
                handleLogout();
                return;
            }
            
            const data = await response.json();
            const select = document.getElementById('booking-room');
            select.innerHTML = '<option value="">Select Room</option>';
            
            data.rooms.forEach(room => {
                const option = document.createElement('option');
                option.value = room.id;
                option.textContent = `${room.type} (${room.number}) - $${room.price}/night`;
                select.appendChild(option);
            });
        } catch (error) {
            console.error('Error loading rooms for booking:', error);
        }
    }
    
    // Load customers for booking form
    async function loadCustomersForBooking() {
        try {
            const userData = JSON.parse(localStorage.getItem('hotelUser'));
            const response = await fetch('/api/customers', {
                headers: {
                    'Authorization': `Bearer ${userData.token}`
                }
            });
            
            if (response.status === 401) {
                handleLogout();
                return;
            }
            
            const data = await response.json();
            const select = document.getElementById('booking-customer');
            select.innerHTML = '<option value="">Select Customer</option>';
            
            data.customers.forEach(customer => {
                const option = document.createElement('option');
                option.value = customer.id;
                option.textContent = `${customer.name} (${customer.email})`;
                select.appendChild(option);
            });
        } catch (error) {
            console.error('Error loading customers for booking:', error);
        }
    }
    
    // Handle add room
    async function handleAddRoom(e) {
        e.preventDefault();
        
        // In a real app, you would implement this
        alert('Room added successfully (mock)');
        closeAllModals();
        addRoomForm.reset();
        loadRooms();
    }
    
    // Handle add booking
    async function handleAddBooking(e) {
        e.preventDefault();
        
        const roomId = document.getElementById('booking-room').value;
        const customerId = document.getElementById('booking-customer').value;
        const checkIn = document.getElementById('check-in-date').value;
        const checkOut = document.getElementById('check-out-date').value;
        
        try {
            const userData = JSON.parse(localStorage.getItem('hotelUser'));
            const response = await fetch('/api/bookings', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'Authorization': `Bearer ${userData.token}`
                },
                body: JSON.stringify({
                    room_id: parseInt(roomId),
                    customer_id: customerId,
                    check_in: checkIn,
                    check_out: checkOut
                })
            });
            
            if (response.status === 401) {
                handleLogout();
                return;
            }
            
            const data = await response.json();
            
            if (response.status === 201) {
                alert('Booking created successfully');
                closeAllModals();
                addBookingForm.reset();
                loadBookings();
                loadDashboardData();
            } else {
                alert(data.message || 'Failed to create booking');
            }
        } catch (error) {
            console.error('Error creating booking:', error);
            alert('An error occurred while creating booking');
        }
    }
    
    // Handle add/update customer
    async function handleAddCustomer(e) {
        e.preventDefault();
        
        const name = document.getElementById('customer-name').value;
        const email = document.getElementById('customer-email').value;
        const phone = document.getElementById('customer-phone').value;
        const idProof = document.getElementById('customer-id-proof').value;
        const idNumber = document.getElementById('customer-id-number').value;
        const address = document.getElementById('customer-address').value;
        
        const form = document.getElementById('add-customer-form');
        const customerId = form.getAttribute('data-customer-id');
        const isUpdate = !!customerId;
        
        try {
            const userData = JSON.parse(localStorage.getItem('hotelUser'));
            
            // In a real app, you would send this to your backend
            // For this mock implementation, we'll just update the local data
            if (isUpdate) {
                // Find and update the customer
                const response = await fetch('/api/customers', {
                    headers: {
                        'Authorization': `Bearer ${userData.token}`
                    }
                });
                
                if (response.status === 401) {
                    handleLogout();
                    return;
                }
                
                const data = await response.json();
                const customers = data.customers;
                const customerIndex = customers.findIndex(c => c.id === customerId);
                
                if (customerIndex !== -1) {
                    customers[customerIndex] = {
                        ...customers[customerIndex],
                        name,
                        email,
                        phone,
                        id_proof: idProof,
                        id_number: idNumber,
                        address
                    };
                    
                    alert('Customer updated successfully');
                }
            } else {
                // Add new customer
                const response = await fetch('/api/customers', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${userData.token}`
                    },
                    body: JSON.stringify({
                        name,
                        email,
                        phone,
                        id_proof: idProof,
                        id_number: idNumber,
                        address
                    })
                });
                
                if (response.status === 401) {
                    handleLogout();
                    return;
                }
                
                const data = await response.json();
                
                if (response.status !== 201) {
                    alert(data.message || 'Failed to add customer');
                    return;
                }
                
                alert('Customer added successfully');
            }
            
            closeAllModals();
            addCustomerForm.reset();
            form.removeAttribute('data-customer-id');
            form.querySelector('button').textContent = 'Add Customer';
            loadCustomers();
        } catch (error) {
            console.error('Error saving customer:', error);
            alert('An error occurred while saving customer');
        }
    }
    
    // Show booking details
    async function showBookingDetails(bookingId) {
        try {
            const userData = JSON.parse(localStorage.getItem('hotelUser'));
            const response = await fetch(`/api/bookings/${bookingId}`, {
                headers: {
                    'Authorization': `Bearer ${userData.token}`
                }
            });
            
            if (response.status === 401) {
                handleLogout();
                return;
            }
            
            if (!response.ok) {
                throw new Error('Failed to fetch booking details');
            }
            
            const booking = await response.json();
            
            // Populate modal content
            const content = document.getElementById('booking-details-content');
            content.innerHTML = `
                <h4>Booking #${booking.id.substring(0, 8)}...</h4>
                <p><strong>Status:</strong> <span class="status status-${booking.status}">${booking.status}</span></p>
                <p><strong>Payment Status:</strong> <span class="status status-${booking.payment_status}">${booking.payment_status}</span></p>
                
                <div class="form-row mt-20">
                    <div class="form-col">
                        <h5>Room Details</h5>
                        <p><strong>Type:</strong> ${booking.room.type}</p>
                        <p><strong>Number:</strong> ${booking.room.number}</p>
                        <p><strong>Price:</strong> $${booking.room.price}/night</p>
                    </div>
                    <div class="form-col">
                        <h5>Customer Details</h5>
                        <p><strong>Name:</strong> ${booking.customer.name}</p>
                        <p><strong>Email:</strong> ${booking.customer.email}</p>
                        <p><strong>Phone:</strong> ${booking.customer.phone}</p>
                    </div>
                </div>
                
                <div class="form-row mt-20">
                    <div class="form-col">
                        <h5>Dates</h5>
                        <p><strong>Check-in:</strong> ${booking.check_in}</p>
                        <p><strong>Check-out:</strong> ${booking.check_out}</p>
                        <p><strong>Duration:</strong> ${(new Date(booking.check_out) - new Date(booking.check_in)) / (1000 * 60 * 60 * 24)} nights</p>
                    </div>
                    <div class="form-col">
                        <h5>Payment</h5>
                        <p><strong>Total Amount:</strong> $${booking.total_amount}</p>
                        <p><strong>Created At:</strong> ${booking.created_at}</p>
                    </div>
                </div>
            `;
            
            // Show/hide checkout button based on booking status
            const checkoutBtn = document.getElementById('checkout-btn');
            checkoutBtn.style.display = booking.status === 'active' ? 'inline-block' : 'none';
            checkoutBtn.setAttribute('data-booking-id', booking.id);
            
            // Set up invoice button
            const invoiceBtn = document.getElementById('generate-invoice-btn');
            invoiceBtn.setAttribute('data-booking-id', booking.id);
            
            openModal('booking-details-modal');
        } catch (error) {
            console.error('Error loading booking details:', error);
            alert('Failed to load booking details');
        }
    }
    
    // Checkout booking
    async function checkoutBooking(bookingId) {
        if (!confirm('Are you sure you want to checkout this booking?')) return;
        
        try {
            const userData = JSON.parse(localStorage.getItem('hotelUser'));
            const response = await fetch(`/api/bookings/${bookingId}/checkout`, {
                method: 'POST',
                headers: {
                    'Authorization': `Bearer ${userData.token}`
                }
            });
            
            if (response.status === 401) {
                handleLogout();
                return;
            }
            
            const data = await response.json();
            
            if (data.success) {
                alert('Checkout completed successfully');
                closeAllModals();
                loadBookings();
                loadDashboardData();
                loadRooms();
            } else {
                alert(data.message || 'Failed to checkout booking');
            }
        } catch (error) {
            console.error('Error checking out booking:', error);
            alert('An error occurred during checkout');
        }
    }
    
    // Generate invoice - update this in your script section
document.getElementById('generate-invoice-btn').addEventListener('click', function() {
    const bookingId = this.getAttribute('data-booking-id');
    const userData = JSON.parse(localStorage.getItem('hotelUser'));
    
    // Create a temporary link with the token
    const link = document.createElement('a');
    link.href = `/api/invoice/${bookingId}`;
    link.setAttribute('download', `invoice_${bookingId}.pdf`);
    
    // Add authorization header through a custom header
    link.setAttribute('data-token', userData.token);
    
    // Add click event to handle the authorization
    link.addEventListener('click', function(e) {
        e.preventDefault();
        fetch(this.href, {
            headers: {
                'Authorization': `Bearer ${this.getAttribute('data-token')}`
            }
        })
        .then(response => {
            if (response.ok) return response.blob();
            throw new Error('Failed to generate invoice');
        })
        .then(blob => {
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `invoice_${bookingId}.pdf`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            window.URL.revokeObjectURL(url);
        })
        .catch(error => {
            console.error('Error generating invoice:', error);
            alert('Failed to generate invoice');
        });
    });
    
    // Trigger the click
    link.click();
});
</script>
</body>
</html>